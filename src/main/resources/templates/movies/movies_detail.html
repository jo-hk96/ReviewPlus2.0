<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" 
                  xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>ë¦¬ë·°í”ŒëŸ¬ìŠ¤</title>
    <link rel="stylesheet" href="/css/movies_detail.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/scroll-to-top.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%2210 0 100 100%22><text y=%22.90em%22 font-size=%2290%22>ğŸ¬</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
</head>
<style>
	.reply-form-hidden {
	    display: none;
	}
	
	.reply-hidden {
	    display: none;
	}
	body{
		background-color: #191932;
	}
	
	
	#userProfilePicture{
		width: 50px;
		height: 50px;
		border-radius: 25px;
		border:1px solid white;
		object-fit:cover;
	}

</style>

<body>
	<!-- í—¤ë” -->
	<div th:insert = "index/index :: header"></div>
		<!-- ì˜í™” ìƒì„¸ ì •ë³´ -->
	<main>
		<section id="movie-detail-container">
			<h2>ì˜í™” ìƒì„¸ ì •ë³´</h2>
			<p>ìƒì„¸ì •ë³´ ë¶ˆëŸ¬ì˜¤ëŠ”ì¤‘</p>
		</section>
		<section class="movie-actions">
			<div class="like-action">
				<button
					id="likeButton"
					th:data-api-id="${apiId}"
					th:data-liked="${isLiked}"
					th:classappend="${isLiked} ? 'liked' : ''"
					th:text="${isLiked} ? 'â™¥ ì¢‹ì•„ìš”' : 'â™¡ ì¢‹ì•„ìš”'"
					onclick="toggleLike(this)"
					class="like-btn"
					aria-pressed="${isLiked}">
					ì¢‹ì•„ìš” ë²„íŠ¼
				</button>
			</div>
		</section>
</main>

	<!-- ë¦¬ë·° ì‘ì„± ì„¹ì…˜ -->
	<section class="movie-reviews">
		<hr>
			<div sec:authorize="isAuthenticated()" class="review-form-container">
				<h2 style = "color:white;">ë¦¬ë·°ì“°ê¸°</h2>
				<form id="review-form">
					<p>
						<b>ë‹‰ë„¤ì„:</b> <span sec:authentication="principal.nickname" id="nickname"></span>
					</p>
					
					<div class="form-group">
						<label for="review-comment">í‰ê°€:</label>
						<textarea id="review-comment" rows="5" cols="30" name="comment" placeholder="ë¦¬ë·°ë¥¼ ì‘ì„±í•´ ì£¼ì„¸ìš”."></textarea>
					</div>

					<div class="form-group">
						<strong>í‰ì :</strong>
						<div class="rating-area" role="radiogroup" aria-label="í‰ì  ì„ íƒ">
							<span class="star" data-rating="1" tabindex="0" role="radio" aria-checked="false">â˜…</span>
							<span class="star" data-rating="2" tabindex="0" role="radio" aria-checked="false">â˜…</span>
							<span class="star" data-rating="3" tabindex="0" role="radio" aria-checked="false">â˜…</span>
							<span class="star" data-rating="4" tabindex="0" role="radio" aria-checked="false">â˜…</span>
							<span class="star" data-rating="5" tabindex="0" role="radio" aria-checked="false">â˜…</span>
						</div>
					</div>
					<button type="button" id="submit-review-btn">ë¦¬ë·° ë“±ë¡</button>
				</form>
			</div>
					<div sec:authorize="isAuthenticated()">
					    <input type="hidden" id="loggedInUserId" th:value="${#authentication.principal.userId}"> 
					</div>
					<div class="review-list-container">
							<h2 style = "color:white;">ë¦¬ë·°</h2>
							<div id="review-list">
								<p th:if="${reviews == null or reviews.isEmpty()}" class="no-reviews-message">
									ì•„ì§ ë“±ë¡ëœ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤.
								</p>
							</div>
					</div>
		</section>
					<input type="hidden" id="current-review-id" th:value="${reviewId}">
					<input type="hidden" id="selected-rating" name="rating" value="0">
					<input type="hidden" id="apiId" name="apiId" th:value="${apiId}">



<!-- ìˆ˜ì • ëª¨ë‹¬ -->		
<div id="editReviewModal">
    <div style="background-color: white; width: 80%; max-width: 500px; margin: 100px auto; padding: 20px; border-radius: 8px;">
        <h3>ë¦¬ë·° ìˆ˜ì •í•˜ê¸°</h3>
        <div class="form-group">
            <label for="editComment">ëŒ“ê¸€ ìˆ˜ì •:</label>
            <textarea id="editComment" rows="4" cols="50"></textarea>
        </div>

        <div class="form-group">
            <strong>í‰ì  ìˆ˜ì •:</strong>
            <div id="editRatingArea" class="rating-area" role="radiogroup" aria-label="ìˆ˜ì • í‰ì  ì„ íƒ">
                <span class="star" data-rating="1" tabindex="0" role="radio" aria-checked="false">â˜…</span>
                <span class="star" data-rating="2" tabindex="0" role="radio" aria-checked="false">â˜…</span>
                <span class="star" data-rating="3" tabindex="0" role="radio" aria-checked="false">â˜…</span>
                <span class="star" data-rating="4" tabindex="0" role="radio" aria-checked="false">â˜…</span>
                <span class="star" data-rating="5" tabindex="0" role="radio" aria-checked="false">â˜…</span>
            </div>
        </div>

        <input type="hidden" id="editingReviewId" value="">
        <input type="hidden" id="editSelectedRating" value="0"> 
        <button type="button" id="saveEditBtn">ìˆ˜ì • ì™„ë£Œ</button>
        <button type="button" onclick="document.getElementById('editReviewModal').style.display='none'">ì·¨ì†Œ</button>
    </div>
</div>

    <!-- í”„ë¡œí•„ ì‚¬ì§„ -->
	<script src="js/upload.js"></script>
	<!-- í‘¸í„° -->
	<footer th:insert="index/index :: footer"></footer>
	<!-- ë§¨ìœ„ë¡œ ê°€ê¸° -->
	<div th:insert ="index/index :: scroll-to-top"></div>
	<!-- ì˜í™” ë¦¬ë·° ëª©ë¡ -->
	<script src="/js/movies_review.js"></script>
	<!-- ì˜í™” ìƒì„¸ ì •ë³´ -->
	<script src="/js/movies_detail.js"></script>
	<!-- ì˜í™” ì¢‹ì•„ìš” ë²„íŠ¼ -->
	<script src="/js/movie_LikeBtn.js"></script>
	<!-- scroll-to-top -->
	<script src="/js/scroll-to-top.js"></script>
</body>
</html>


